<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecommerce.mapper.ProductMapper">
    <select id="selectByCondition" resultType="com.ecommerce.model.entity.Product">
        SELECT *
        FROM product
        <where>
            <if test="name != null and name != ''">
                AND name LIKE CONCAT('%', #{name}, '%')
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId}
            </if>
            <if test="status != null">
                AND status = #{status}
            </if>
            <if test="minPrice != null">
                AND price >= #{minPrice}
            </if>
            <if test="maxPrice != null">
                AND price &lt;= #{maxPrice}
            </if>
            <!-- inStock条件暂时注释掉进行调试 -->
            <!-- <if test="inStock == true">
                AND stock > 0
            </if> -->
            <!-- 处理额外的参数以避免MyBatis参数映射错误 -->
            <if test="offset != null">
                <!-- offset参数由PageHelper处理，这里不需要实际使用 -->
            </if>
            <if test="adminQuery != null">
                <!-- adminQuery参数用于业务逻辑判断，SQL中不需要处理 -->
            </if>
        </where>
        ORDER BY create_time DESC
    </select>
</mapper>